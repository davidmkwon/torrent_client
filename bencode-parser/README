mostly adapted from https://github.com/rgrinberg/bencode
